% find_poly_coeff_Z_vs_sz

clear all
clf

scal = 1e0;
Z = [6 36 3240 1279200 20476800  49995000]./scal; % nr.combinations
Sz = [24 144 18720 11021907 197684307 488891106]./scal; % file size
% [P,S,MU] = polyfit(Z,Sz,1);
P = polyfit(Z,Sz,1);

% P(1:2)

hold on;
plot(Z,Sz,'r^-','linewidth',5,'MarkerSize',5);


Zt = 0:1e2:1e8;
Szt = P(1).*Zt + P(2);
plot(Zt,Szt,'b-','linewidth',2);


% np = [2 3 9     57 73 89 105 121 137 153 169 185 201];
np = [2 3  9 17 41  57 73 89 105 121 137 153 169 185 201];
Np = np.^2; 
Zp = (Np-1).*Np/2;
Szp = P(1).*Zp + P(2);
plot(Zp,Szp,'k-','linewidth',2);

M = [np' Np' Zp' Szp'./(1024^0) Szp'./(1024^1) Szp'./(1024^2) Szp'./(1024^3)];
r = 66;
M(M<0)=0;

fprintf([ repmat('=',1,r) '\n'])

head = [' n  | N=n^2 |     Z     |' repmat(' ',1,5) ...
	    'sz(B)   | ' ...
	    'sz(KiB) | ' ...
	    'sz(MiB)|' ...
	    'sz(GiB)|\n'];

% frmt = ['n = %3.0f  N = %5.0f  Z = %9.0f '...
% 	'| B = %10.0f  KiB = %8.0f  MiB = %6.1f  GiB = %4.1f\n'];

frmt = ['%3.0f | %5.0f | %9.0f '...
	'| %10.0f  | %7.0f | %6.1f | %5.1f | \n'];

fprintf(head)
fprintf([ repmat('-',1,r) '\n'])
fprintf(frmt, M(1:2,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(3:5,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(6:8,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(9:11,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(12:end,:)')

fprintf([ repmat('=',1,r) '\n\n'])


% ==================================================================
%  n  | N=n^2 |     Z     |     sz(B)   | sz(KiB) | sz(MiB)|sz(GiB)|
% ------------------------------------------------------------------
%   2 |     4 |         6 |          0  |       0 |    0.0 |   0.0 | 
%   3 |     9 |        36 |          0  |       0 |    0.0 |   0.0 | 
%   9 |    81 |      3240 |          0  |       0 |    0.0 |   0.0 | 
% ------------------------------------------------------------------
%  57 |  3249 |   5276376 |   50939387  |   49745 |   48.6 |   0.0 | 
%  73 |  5329 |  14196456 |  138142342  |  134905 |  131.7 |   0.1 | 
%  89 |  7921 |  31367160 |  306003631  |  298832 |  291.8 |   0.3 | 
% ------------------------------------------------------------------
% 105 | 11025 |  60769800 |  593444674  |  579536 |  566.0 |   0.6 | 
% 121 | 14641 | 107172120 | 1047075070  | 1022534 |  998.6 |   1.0 | 
% 137 | 18769 | 176128296 | 1721192603  | 1680852 | 1641.5 |   1.6 | 
% ------------------------------------------------------------------
% 153 | 23409 | 273978936 | 2677783235  | 2615023 | 2553.7 |   2.5 | 
% 169 | 28561 | 407851080 | 3986521113  | 3893087 | 3801.8 |   3.7 | 
% 185 | 34225 | 585658200 | 5724768561  | 5590594 | 5459.6 |   5.3 | 
% 201 | 40401 | 816100200 | 7977576090  | 7790602 | 7608.0 |   7.4 | 
% ==================================================================

% np = [2 3 9      57 73 89 105 121 137 153 169 185 201];
np = [2 3  9 17 41  57 73 89 105 121 137 153 169 185 201];

Np = np.^2; 
fSet = (Np-1).*Np/2;

for ii = size(fSet,2):-1:2;

	cSet(ii) = fSet(ii) - fSet(ii-1);

end

cSet(1) = fSet(1);

M = [np' Np' fSet' fSet'./1e6 cSet' cSet'./1e6 ];
r = 59;

fprintf([ repmat('=',1,r) '\n'])

head = [' n  | N=n^2 |     Z     |    '  ...
	    'Z[1e6]  |  cSet  | cSet[1e6] | \n'];

frmt = ['%3.0f | %5.0f | %9.0f '...
	'| %6.0f  | %9.0f | %9.0f | \n'];

fprintf(head)
fprintf([ repmat('-',1,r) '\n'])
fprintf(frmt, M(1:2,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(3:5,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(6:8,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(9:11,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(11:end,:)')

fprintf([ repmat('-',1,r) '\n'])
fprintf('sum of cSets: %6.0f\n', sum(cSet)/1e6);

fprintf([ repmat('=',1,r) '\n'])


% ===========================================================
%  n  | N=n^2 |     Z     |    Z[1e6]  |  cSet  | cSet[1e6] | 
% -----------------------------------------------------------
%   2 |     4 |         6 |      0  |         6 |         0 | 
%   3 |     9 |        36 |      0  |        30 |         0 | 
%   9 |    81 |      3240 |      0  |      3204 |         0 | 
% -----------------------------------------------------------
%  57 |  3249 |   5276376 |      5  |   5273136 |         5 | 
%  73 |  5329 |  14196456 |     14  |   8920080 |         9 | 
%  89 |  7921 |  31367160 |     31  |  17170704 |        17 | 
% -----------------------------------------------------------
% 105 | 11025 |  60769800 |     61  |  29402640 |        29 | 
% 121 | 14641 | 107172120 |    107  |  46402320 |        46 | 
% 137 | 18769 | 176128296 |    176  |  68956176 |        69 | 
% -----------------------------------------------------------
% 153 | 23409 | 273978936 |    274  |  97850640 |        98 | 
% 169 | 28561 | 407851080 |    408  | 133872144 |       134 | 
% 185 | 34225 | 585658200 |    586  | 177807120 |       178 | 
% 201 | 40401 | 816100200 |    816  | 230442000 |       230 | 
% -----------------------------------------------------------
% sum of cSets:    816
% ===========================================================

