% find_poly_coeff_Z_vs_sz

clear all
clf

scal = 1e0;
Z = [6 36 3240 1279200 20476800  49995000]./scal; % nr.combinations
Sz = [24 144 18720 11021907 197684307 488891106]./scal; % file size
% [P,S,MU] = polyfit(Z,Sz,1);
P = polyfit(Z,Sz,1);

% P(1:2)

hold on;
plot(Z,Sz,'r^-','linewidth',5,'MarkerSize',5);


Zt = 0:1e2:1e8;
Szt = P(1).*Zt + P(2);
plot(Zt,Szt,'b-','linewidth',2);


np = [2 3 9 40 80 100 120 140 160 180 200];
Np = np.^2; 
Zp = (Np-1).*Np/2;
Szp = P(1).*Zp + P(2);
plot(Zp,Szp,'k-','linewidth',2);

M = [np' Np' Zp' Szp'./(1024^0) Szp'./(1024^1) Szp'./(1024^2) Szp'./(1024^3)];
r = 92;

fprintf([ repmat('=',1,r) '\n'])

head = [' n  | N=n^2 |     Z     |' repmat(' ',1,5) ...
	    'sz(B)   | ' ...
	    'sz(KiB) | ' ...
	    'sz(MiB)|' ...
	    'sz(GiB)|\n'];

% frmt = ['n = %3.0f  N = %5.0f  Z = %9.0f '...
% 	'| B = %10.0f  KiB = %8.0f  MiB = %6.1f  GiB = %4.1f\n'];

frmt = ['%3.0f | %5.0f | %9.0f '...
	'| %10.0f  | %7.0f | %6.1f | %5.1f | \n'];

fprintf(head)
fprintf([ repmat('-',1,r) '\n'])
fprintf(frmt, M(1:3,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(4:6,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(7:8,:)')

fprintf([ repmat('-',1,r) '\n'])

fprintf(frmt, M(9:end,:)')

fprintf([ repmat('=',1,r) '\n'])


% ============================================================================================
%                                   |     sz(B)           sz(KiB)        sz(MiB)     sz(GiB)
% n =   2  N =     4  Z =         6 | B =    -642556  KiB =     -627  MiB =   -0.6  GiB = -0.0
% n =   3  N =     9  Z =        36 | B =    -642263  KiB =     -627  MiB =   -0.6  GiB = -0.0
% n =   9  N =    81  Z =      3240 | B =    -610940  KiB =     -597  MiB =   -0.6  GiB = -0.0
% --------------------------------------------------------------------------------------------
% n =  40  N =  1600  Z =   1279200 | B =   11862881  KiB =    11585  MiB =   11.3  GiB =  0.0
% n =  80  N =  6400  Z =  20476800 | B =  199539163  KiB =   194862  MiB =  190.3  GiB =  0.2
% n = 100  N = 10000  Z =  49995000 | B =  488109923  KiB =   476670  MiB =  465.5  GiB =  0.5
% --------------------------------------------------------------------------------------------
% n = 120  N = 14400  Z = 103672800 | B = 1012865619  KiB =   989127  MiB =  965.9  GiB =  0.9
% n = 140  N = 19600  Z = 192070200 | B = 1877041109  KiB =  1833048  MiB = 1790.1  GiB =  1.7
% --------------------------------------------------------------------------------------------
% n = 160  N = 25600  Z = 327667200 | B = 3202641227  KiB =  3127579  MiB = 3054.3  GiB =  3.0
% n = 180  N = 32400  Z = 524863800 | B = 5130440783  KiB =  5010196  MiB = 4892.8  GiB =  4.8
% n = 200  N = 40000  Z = 799980000 | B = 7819984558  KiB =  7636704  MiB = 7457.7  GiB =  7.3
% ============================================================================================